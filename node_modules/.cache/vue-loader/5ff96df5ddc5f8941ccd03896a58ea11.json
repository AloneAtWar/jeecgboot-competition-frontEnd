{"remainingRequest":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a\\ant-design-vue-jeecg\\src\\components\\jeecg\\JVxeTable\\components\\cells\\JVxeDepartSelectCell.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\a\\ant-design-vue-jeecg\\src\\components\\jeecg\\JVxeTable\\components\\cells\\JVxeDepartSelectCell.vue","mtime":1661074531190},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657458637011},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1657458618345},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657458637011},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1657458571653}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport JVxeCellMixins, { dispatchEvent } from '@/components/jeecg/JVxeTable/mixins/JVxeCellMixins'\nimport JSelectDepartModal from '@/components/jeecgbiz/modal/JSelectDepartModal'\n\nexport default {\n  name: 'JVxeDepartSelectCell',\n  mixins: [JVxeCellMixins],\n  components:{\n    JSelectDepartModal\n  },\n  data() {\n    return {\n      departNames: '',\n      departIds: '',\n      selectedOptions: [],\n      customReturnField: 'id'\n    }\n  },\n  computed: {\n    custProps() {\n      const {departIds, originColumn: col, caseId, cellProps} = this\n      return {\n        ...cellProps,\n        value: departIds,\n        field: col.field || col.key,\n        groupId: caseId,\n        class: 'jvxe-select'\n      }\n    },\n    componentDisabled(){\n      if(this.cellProps.disabled==true){\n        return true\n      }\n      return false\n    },\n    modalWidth(){\n      if(this.cellProps.modalWidth){\n        return this.cellProps.modalWidth\n      }else{\n        return 500\n      }\n    },\n    multi(){\n      if(this.cellProps.multi==false || this.originColumn.multi===false){\n        return false\n      }else{\n        return true\n      }\n    },\n    rootOpened(){\n      if(this.cellProps.open==false){\n        return false\n      }else{\n        return true\n      }\n    }\n  },\n  watch: {\n    innerValue: {\n      immediate: true,\n      handler(val) {\n        if (val == null || val === '') {\n          this.departIds = ''\n        } else {\n          this.departIds = val\n        }\n      }\n    }\n  },\n  methods: {\n    openSelect(){\n      // disabled 不弹窗\n      if (this.componentDisabled) {\n        return\n      }\n      this.$refs.innerDepartSelectModal.show()\n    },\n    handleEmpty(){\n      this.handleOK('')\n    },\n    handleOK(rows) {\n      let value = ''\n      if (!rows && rows.length <= 0) {\n        this.departNames = ''\n        this.departIds = ''\n      } else {\n        let storeField = this.storeField();\n        let textField = this.textField();\n        value = rows.map(row => row[storeField]).join(',')\n        this.departNames = rows.map(row => row[textField]).join(',')\n        this.departIds = value\n      }\n      this.handleChangeCommon(this.departIds)\n    },\n    initComp(departNames){\n      this.departNames = departNames\n    },\n    handleChange(value) {\n      this.handleChangeCommon(value)\n    },\n    storeField(){\n      if(this.originColumn){\n        const str = this.originColumn.fieldExtendJson\n        if(str){\n          let json = JSON.parse(str)\n          if(json && json.store){\n            return json.store\n          }\n        }else if(this.originColumn.store){\n          return this.originColumn.store\n        }\n      }\n      return 'id'\n    },\n    textField(){\n      if(this.originColumn){\n        const str = this.originColumn.fieldExtendJson\n        if(str){\n          let json = JSON.parse(str)\n          if(json && json.text){\n            return json.text\n          }\n        }else if(this.originColumn.text){\n          return this.originColumn.text\n        }\n      }\n      return 'departName'\n    }\n  },\n  enhanced: {\n    switches: {\n      visible: true\n    },\n    translate: {\n      enabled: false\n    }\n  }\n}\n",{"version":3,"sources":["JVxeDepartSelectCell.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JVxeDepartSelectCell.vue","sourceRoot":"src/components/jeecg/JVxeTable/components/cells","sourcesContent":["<template>\r\n  <div>\r\n      <a-input\r\n        v-show=\"!departIds\"\r\n        @click=\"openSelect\"\r\n        placeholder=\"请点击选择部门\"\r\n        v-model=\"departNames\"\r\n        readOnly\r\n        :disabled=\"componentDisabled\"\r\n        class=\"jvxe-select-input\">\r\n        <a-icon slot=\"prefix\" type=\"cluster\" title=\"部门选择控件\"/>\r\n      </a-input>\r\n      <j-select-depart-modal\r\n        ref=\"innerDepartSelectModal\"\r\n        :modal-width=\"modalWidth\"\r\n        :multi=\"multi\"\r\n        :rootOpened=\"rootOpened\"\r\n        :depart-id=\"departIds\"\r\n        :store=\"storeField()\"\r\n        :text=\"textField()\"\r\n        @ok=\"handleOK\"\r\n        @initComp=\"initComp\"/>\r\n    <span style=\"display: inline-block;height:100%;padding-left:14px\" v-if=\"departIds\" >\r\n      <span @click=\"openSelect\" style=\"display: inline-block;vertical-align: middle\">{{ departNames }}</span>\r\n      <a-icon v-if=\"!componentDisabled\" style=\"margin-left:5px;vertical-align: middle\" type=\"close-circle\" @click=\"handleEmpty\" title=\"清空\"/>\r\n    </span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import JVxeCellMixins, { dispatchEvent } from '@/components/jeecg/JVxeTable/mixins/JVxeCellMixins'\r\n  import JSelectDepartModal from '@/components/jeecgbiz/modal/JSelectDepartModal'\r\n\r\n  export default {\r\n    name: 'JVxeDepartSelectCell',\r\n    mixins: [JVxeCellMixins],\r\n    components:{\r\n      JSelectDepartModal\r\n    },\r\n    data() {\r\n      return {\r\n        departNames: '',\r\n        departIds: '',\r\n        selectedOptions: [],\r\n        customReturnField: 'id'\r\n      }\r\n    },\r\n    computed: {\r\n      custProps() {\r\n        const {departIds, originColumn: col, caseId, cellProps} = this\r\n        return {\r\n          ...cellProps,\r\n          value: departIds,\r\n          field: col.field || col.key,\r\n          groupId: caseId,\r\n          class: 'jvxe-select'\r\n        }\r\n      },\r\n      componentDisabled(){\r\n        if(this.cellProps.disabled==true){\r\n          return true\r\n        }\r\n        return false\r\n      },\r\n      modalWidth(){\r\n        if(this.cellProps.modalWidth){\r\n          return this.cellProps.modalWidth\r\n        }else{\r\n          return 500\r\n        }\r\n      },\r\n      multi(){\r\n        if(this.cellProps.multi==false || this.originColumn.multi===false){\r\n          return false\r\n        }else{\r\n          return true\r\n        }\r\n      },\r\n      rootOpened(){\r\n        if(this.cellProps.open==false){\r\n          return false\r\n        }else{\r\n          return true\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      innerValue: {\r\n        immediate: true,\r\n        handler(val) {\r\n          if (val == null || val === '') {\r\n            this.departIds = ''\r\n          } else {\r\n            this.departIds = val\r\n          }\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      openSelect(){\r\n        // disabled 不弹窗\r\n        if (this.componentDisabled) {\r\n          return\r\n        }\r\n        this.$refs.innerDepartSelectModal.show()\r\n      },\r\n      handleEmpty(){\r\n        this.handleOK('')\r\n      },\r\n      handleOK(rows) {\r\n        let value = ''\r\n        if (!rows && rows.length <= 0) {\r\n          this.departNames = ''\r\n          this.departIds = ''\r\n        } else {\r\n          let storeField = this.storeField();\r\n          let textField = this.textField();\r\n          value = rows.map(row => row[storeField]).join(',')\r\n          this.departNames = rows.map(row => row[textField]).join(',')\r\n          this.departIds = value\r\n        }\r\n        this.handleChangeCommon(this.departIds)\r\n      },\r\n      initComp(departNames){\r\n        this.departNames = departNames\r\n      },\r\n      handleChange(value) {\r\n        this.handleChangeCommon(value)\r\n      },\r\n      storeField(){\r\n        if(this.originColumn){\r\n          const str = this.originColumn.fieldExtendJson\r\n          if(str){\r\n            let json = JSON.parse(str)\r\n            if(json && json.store){\r\n              return json.store\r\n            }\r\n          }else if(this.originColumn.store){\r\n            return this.originColumn.store\r\n          }\r\n        }\r\n        return 'id'\r\n      },\r\n      textField(){\r\n        if(this.originColumn){\r\n          const str = this.originColumn.fieldExtendJson\r\n          if(str){\r\n            let json = JSON.parse(str)\r\n            if(json && json.text){\r\n              return json.text\r\n            }\r\n          }else if(this.originColumn.text){\r\n            return this.originColumn.text\r\n          }\r\n        }\r\n        return 'departName'\r\n      }\r\n    },\r\n    enhanced: {\r\n      switches: {\r\n        visible: true\r\n      },\r\n      translate: {\r\n        enabled: false\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  /deep/ .jvxe-select-input .ant-input{\r\n    border: none !important;\r\n  }\r\n</style>"]}]}