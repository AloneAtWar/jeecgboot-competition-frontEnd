{"remainingRequest":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a\\ant-design-vue-jeecg\\src\\views\\jeecg\\TableOrderTotal.vue?vue&type=style&index=0&id=cf21efce&scoped=true&lang=less&","dependencies":[{"path":"D:\\a\\ant-design-vue-jeecg\\src\\views\\jeecg\\TableOrderTotal.vue","mtime":1661074531276},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\css-loader\\index.js","mtime":1657458574837},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1657458571653},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\postcss-loader\\src\\index.js","mtime":1657458638287},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\less-loader\\dist\\cjs.js","mtime":1657458655181},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657458637011},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1657458571653}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/deep/ .chart-data-list .ant-table-footer .ant-table-body{\r\n  overflow: hidden !important;\r\n}\r\n/deep/ .ant-table-footer{\r\n  padding:0;\r\n}\r\n",{"version":3,"sources":["TableOrderTotal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgOA;AACA;AACA;AACA;AACA;AACA","file":"TableOrderTotal.vue","sourceRoot":"src/views/jeecg","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n    <a-row>\r\n      <a-col>\r\n        <a-switch v-bind=\"pageSwitchProps\" v-model=\"pageSwitch\"/>\r\n      </a-col>\r\n      <a-col>\r\n        <a-table\r\n            v-bind=\"tableProps\"\r\n            @change=\"handleTableChange\"\r\n            style=\"margin-top: 20px\"\r\n        >\r\n        </a-table>\r\n      </a-col>\r\n    </a-row>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    name: 'TableTotal',\r\n    data() {\r\n      return {\r\n        columns: [\r\n          {\r\n            title: '#',\r\n            width: '180px',\r\n            align: 'center',\r\n            dataIndex: 'rowIndex',\r\n            customRender: function (text, r, index) {\r\n              return (text !== '总计') ? (parseInt(index) + 1) : text\r\n            }\r\n          },\r\n          {\r\n            title: '姓名',\r\n            dataIndex: 'name',\r\n            width: 180,\r\n          },\r\n          {\r\n            title: '贡献点',\r\n            dataIndex: 'point',\r\n            width: 180,\r\n          },\r\n          {\r\n            title: '等级',\r\n            dataIndex: 'level',\r\n            width: 180,\r\n          },\r\n          {\r\n            title: '更新时间',\r\n            dataIndex: 'updateTime',\r\n            width: 180,\r\n          },\r\n        ],\r\n        /* 分页参数 */\r\n        ipagination:{\r\n          current: 1,\r\n          pageSize: 10,\r\n        },\r\n        dataSource: [\r\n          { id:\"1\",name: '张三', point: 23, level: 3, updateTime: '2019-8-14' },\r\n          { name: '小王', point: 6, level: 1, updateTime: '2019-8-13' },\r\n          { name: '李四', point: 53, level: 8, updateTime: '2019-8-12' },\r\n          { name: '小红', point: 44, level: 5, updateTime: '2019-8-11' },\r\n          { name: '王五', point: 97, level: 10, updateTime: '2019-8-10' },\r\n          { name: '小明', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小张', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小六', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小五', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小赵', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '李华', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小康', point: 33, level: 2, updateTime: '2019-8-10' },\r\n          { name: '小鹿', point: 33, level: 2, updateTime: '2019-8-10' },\r\n        ],\r\n        newArr:[],\r\n        newDataSource:[],\r\n        footerDataSource: [],\r\n        pageSwitch:true\r\n      }\r\n    },\r\n    computed:{\r\n      // 数据表格的固定属性\r\n      tableProps(){\r\n        let tableProps = {\r\n          size: 'middle',\r\n          rowKey:'rowIndex',\r\n          columns: this.columns,\r\n          scroll: {x: true},\r\n        }\r\n        let renderFooter = this.footerDataSource.length === 0 ? null : () => this.renderTableFooter(tableProps)\r\n        return {\r\n          ...tableProps,\r\n          ref: 'table',\r\n          class: 'chart-data-list',\r\n          pagination:this.pageSwitch?this.ipagination:false,\r\n          columns: this.columns,\r\n          dataSource: this.dataSource,\r\n          footer: renderFooter,\r\n        }\r\n      },\r\n      pageSwitchProps() {\r\n        return {\r\n          checkedChildren: '分页',\r\n          unCheckedChildren: '分页',\r\n          style: {\r\n            position: 'absolute',\r\n            right: '0px',\r\n            top: '-10px'\r\n          }\r\n        }\r\n      },\r\n    },\r\n    mounted() {\r\n      // this.tableAddTotalRow(this.columns, this.dataSource)\r\n      /*新增分页合计方法*/\r\n      this.newDataSource=this.dataSource\r\n      this.dataHandling(1,this.ipagination.pageSize)\r\n    },\r\n    watch:{\r\n      //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\r\n      'pageSwitch':function(val){\r\n         if(!val){\r\n           this.dataHandling('-1',0)\r\n         }else{\r\n           this.dataHandling(1,this.ipagination.pageSize)\r\n         }\r\n      },\r\n      'ipagination.current':function(val) {\r\n        this.dataHandling(val,this.ipagination.pageSize)\r\n      },\r\n      //当合计行变化时，绑定滚动条\r\n      'footerDataSource': {\r\n        async handler(dataSource) {\r\n          // 当底部合计行有值，并且显示出来时，再同步滚动条\r\n          if (dataSource && dataSource.length > 0) {\r\n            await this.$nextTick()\r\n            // 同步表与footer滚动\r\n            let dom = this.$refs.table.$el.querySelectorAll('.ant-table-body')[0]\r\n            let footerDom = this.$refs.footerTable.$el.querySelectorAll('.ant-table-body')[0]\r\n            dom.addEventListener(\r\n                'scroll',\r\n                () => {\r\n                  footerDom.scrollLeft = dom.scrollLeft\r\n                },\r\n                true,\r\n            )\r\n          }\r\n        },\r\n        //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\r\n      }\r\n    },\r\n    methods: {\r\n      /** 表格增加合计行 */\r\n      tableAddTotalRow(columns, dataSource) {\r\n        let numKey = 'rowIndex'\r\n        let totalRow = { [numKey]: '合计' }\r\n        columns.forEach(column => {\r\n          let { key, dataIndex } = column\r\n          if (![key, dataIndex].includes(numKey)) {\r\n\r\n            let total = 0\r\n            dataSource.forEach(data => {\r\n              total += /^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN\r\n              console.log(data[dataIndex], ':', (/^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN))\r\n            })\r\n\r\n            if (Number.isNaN(total)) {\r\n              total = '-'\r\n            }\r\n            totalRow[dataIndex] = total\r\n          }\r\n        })\r\n\r\n        dataSource.push(totalRow)\r\n      },\r\n      handleTableChange(pagination, filters, sorter) {\r\n        this.ipagination = pagination;\r\n      },\r\n      //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\r\n      /*如果分页走这个方法*/\r\n      dataHandling(pageNo,pageSize) {\r\n        //根据当前页数和每页显示条数分割数组\r\n        let arrs = [];\r\n        //如果pageNo不是-1（不分页）,那么需要对数据进行分页计算\r\n        if(pageNo!=-1){\r\n          arrs = this.newDataSource.slice((pageNo-1)*pageSize,pageNo*pageSize)\r\n        }else{\r\n          arrs = this.newDataSource\r\n        }\r\n        let newDataSource=[];\r\n        let newArr= { };\r\n        newArr.rowIndex=\"总计\"\r\n        let level=0;\r\n        let point=0;\r\n        //每一项的数值相加\r\n        for (let j=0;j<arrs.length;j++){\r\n          level+=arrs[j].level;\r\n          point+=arrs[j].point;\r\n        }\r\n        newArr.level=level;\r\n        newArr.point=point;\r\n        newDataSource.push(newArr);\r\n        //给foot底部数组赋值\r\n        this.footerDataSource = newDataSource;\r\n      },\r\n      // 渲染表格底部合计行\r\n      renderTableFooter(tableProps) {\r\n        let h = this.$createElement\r\n        return h('a-table', {\r\n          ref: 'footerTable',\r\n          props: {\r\n            ...tableProps,\r\n            pagination: false,\r\n            dataSource: this.footerDataSource,\r\n            showHeader: false,\r\n          },\r\n        })\r\n        //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n/deep/ .chart-data-list .ant-table-footer .ant-table-body{\r\n  overflow: hidden !important;\r\n}\r\n/deep/ .ant-table-footer{\r\n  padding:0;\r\n}\r\n</style>"]}]}