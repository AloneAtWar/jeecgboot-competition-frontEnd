{"remainingRequest":"D:\\a\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a\\ant-design-vue-jeecg\\src\\components\\jeecg\\JImportModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\a\\ant-design-vue-jeecg\\src\\components\\jeecg\\JImportModal.vue","mtime":1661074531178},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657458637011},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1657458618345},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657458637011},{"path":"D:\\a\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1657458571653}],"contextDependencies":[],"result":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { postAction } from '@/api/manage';\nexport default {\n  name: 'JImportModal',\n  props: {\n    url: {\n      type: String,\n      default: '',\n      required: false\n    },\n    biz: {\n      type: String,\n      default: '',\n      required: false\n    },\n    //是否online导入\n    online: {\n      type: Boolean,\n      default: false,\n      required: false\n    }\n  },\n  data: function data() {\n    return {\n      visible: false,\n      uploading: false,\n      fileList: [],\n      uploadAction: '',\n      foreignKeys: '',\n      validateStatus: 0\n    };\n  },\n  watch: {\n    url: function url(val) {\n      if (val) {\n        this.uploadAction = window._CONFIG['domianURL'] + val;\n      }\n    }\n  },\n  created: function created() {\n    this.uploadAction = window._CONFIG['domianURL'] + this.url;\n  },\n  methods: {\n    handleClose: function handleClose() {\n      this.visible = false;\n    },\n    show: function show(arg) {\n      this.fileList = [];\n      this.uploading = false;\n      this.visible = true;\n      this.foreignKeys = arg;\n      this.validateStatus = 0;\n    },\n    handleRemove: function handleRemove(file) {\n      var index = this.fileList.indexOf(file);\n      var newFileList = this.fileList.slice();\n      newFileList.splice(index, 1);\n      this.fileList = newFileList;\n    },\n    beforeUpload: function beforeUpload(file) {\n      this.fileList = [].concat(_toConsumableArray(this.fileList), [file]);\n      return false;\n    },\n    handleImport: function handleImport() {\n      var _this = this;\n\n      var fileList = this.fileList;\n      var formData = new FormData();\n\n      if (this.biz) {\n        formData.append('isSingleTableImport', this.biz);\n      }\n\n      if (this.foreignKeys && this.foreignKeys.length > 0) {\n        formData.append('foreignKeys', this.foreignKeys);\n      }\n\n      if (this.online == true) {\n        formData.append('validateStatus', this.validateStatus);\n      }\n\n      fileList.forEach(function (file) {\n        formData.append('files[]', file);\n      });\n      this.uploading = true;\n      postAction(this.uploadAction, formData).then(function (res) {\n        _this.uploading = false;\n\n        if (res.success) {\n          if (res.code == 201) {\n            _this.errorTip(res.message, res.result);\n          } else {\n            _this.$message.success(res.message);\n          }\n\n          _this.visible = false;\n\n          _this.$emit('ok');\n        } else {\n          _this.$message.warning(res.message);\n        }\n      });\n    },\n    // 是否开启校验 开关改变事件\n    handleChangeValidateStatus: function handleChangeValidateStatus(checked) {\n      this.validateStatus = checked == true ? 1 : 0;\n    },\n    // 错误信息提示\n    errorTip: function errorTip(tipMessage, fileUrl) {\n      var h = this.$createElement;\n      var href = window._CONFIG['domianURL'] + fileUrl;\n      this.$warning({\n        title: '导入成功,但是有错误数据!',\n        content: h('div', {}, [h('div', tipMessage), h('span', '具体详情请 '), h('a', {\n          attrs: {\n            href: href,\n            target: '_blank'\n          }\n        }, '点击下载')]),\n        onOk: function onOk() {}\n      });\n    }\n  }\n};",{"version":3,"sources":["JImportModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    title=\"导入EXCEL\"\r\n    :width=\"600\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"uploading\"\r\n    @cancel=\"handleClose\">\r\n\r\n    <div style=\"margin: 0px 0px 5px 1px\" v-if=\"online\">\r\n      <span style=\"display: inline-block;height: 32px;line-height: 32px;vertical-align: middle;\">是否开启校验:</span>\r\n      <span style=\"display: inline-block;height: 32px;margin-left: 6px\">\r\n         <a-switch :checked=\"validateStatus==1\" @change=\"handleChangeValidateStatus\" checked-children=\"是\" un-checked-children=\"否\" size=\"small\"/>\r\n      </span>\r\n    </div>\r\n\r\n    <a-upload\r\n      name=\"file\"\r\n      :multiple=\"true\"\r\n      accept=\".xls,.xlsx\"\r\n      :fileList=\"fileList\"\r\n      :remove=\"handleRemove\"\r\n      :beforeUpload=\"beforeUpload\">\r\n      <a-button>\r\n        <a-icon type=\"upload\" />\r\n        选择导入文件\r\n      </a-button>\r\n    </a-upload>\r\n\r\n    <template slot=\"footer\">\r\n      <a-button @click=\"handleClose\">关闭</a-button>\r\n      <a-button\r\n        type=\"primary\"\r\n        @click=\"handleImport\"\r\n        :disabled=\"fileList.length === 0\"\r\n        :loading=\"uploading\">\r\n        {{ uploading ? '上传中...' : '开始上传' }}\r\n      </a-button>\r\n    </template>\r\n\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import { postAction } from '@/api/manage'\r\n  export default {\r\n    name: 'JImportModal',\r\n    props:{\r\n      url:{\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      biz:{\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      //是否online导入\r\n      online:{\r\n        type: Boolean,\r\n        default: false,\r\n        required: false\r\n      }\r\n    },\r\n    data(){\r\n      return {\r\n        visible:false,\r\n        uploading:false,\r\n        fileList:[],\r\n        uploadAction:'',\r\n        foreignKeys:'',\r\n        validateStatus: 0\r\n      }\r\n    },\r\n    watch: {\r\n      url (val) {\r\n        if(val){\r\n         this.uploadAction = window._CONFIG['domianURL']+val\r\n        }\r\n      }\r\n    },\r\n    created () {\r\n      this.uploadAction = window._CONFIG['domianURL']+this.url\r\n    },\r\n\r\n    methods:{\r\n      handleClose(){\r\n        this.visible=false\r\n      },\r\n      show(arg){\r\n        this.fileList = []\r\n        this.uploading = false\r\n        this.visible = true\r\n        this.foreignKeys = arg;\r\n        this.validateStatus = 0\r\n      },\r\n      handleRemove(file) {\r\n        const index = this.fileList.indexOf(file);\r\n        const newFileList = this.fileList.slice();\r\n        newFileList.splice(index, 1);\r\n        this.fileList = newFileList\r\n      },\r\n      beforeUpload(file) {\r\n        this.fileList = [...this.fileList, file]\r\n        return false;\r\n      },\r\n      handleImport() {\r\n        const { fileList } = this;\r\n        const formData = new FormData();\r\n        if(this.biz){\r\n          formData.append('isSingleTableImport',this.biz);\r\n        }\r\n        if(this.foreignKeys && this.foreignKeys.length>0){\r\n          formData.append('foreignKeys',this.foreignKeys);\r\n        }\r\n        if(this.online==true){\r\n          formData.append('validateStatus',this.validateStatus);\r\n        }\r\n        fileList.forEach((file) => {\r\n          formData.append('files[]', file);\r\n        });\r\n        this.uploading = true\r\n        postAction(this.uploadAction, formData).then((res) => {\r\n          this.uploading = false\r\n          if(res.success){\r\n            if(res.code == 201){\r\n              this.errorTip(res.message, res.result)\r\n            }else{\r\n              this.$message.success(res.message)\r\n            }\r\n            this.visible=false\r\n            this.$emit('ok')\r\n          }else{\r\n            this.$message.warning(res.message)\r\n          }\r\n        })\r\n      },\r\n      // 是否开启校验 开关改变事件\r\n      handleChangeValidateStatus(checked){\r\n        this.validateStatus = checked==true?1:0\r\n      },\r\n      // 错误信息提示\r\n      errorTip(tipMessage, fileUrl) {\r\n        const h = this.$createElement;\r\n        let href = window._CONFIG['domianURL'] + fileUrl\r\n        this.$warning({\r\n          title: '导入成功,但是有错误数据!',\r\n          content: h('div', {}, [\r\n            h('div', tipMessage),\r\n            h('span', '具体详情请 '),\r\n            h('a', {\r\n              attrs: {\r\n                href: href,\r\n                target: '_blank'\r\n              },\r\n            },'点击下载'),\r\n          ]),\r\n          onOk() {},\r\n        });\r\n      },\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/components/jeecg"}]}